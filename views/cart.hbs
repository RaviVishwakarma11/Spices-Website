<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://kit.fontawesome.com/8f27d68390.js" crossorigin="anonymous"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

  <link rel="stylesheet" href="cart.css" />
  <title>Cart_Page</title>
  <script>
   
      
      function checkoutPage(){
        var value = document.getElementById("subtotal").innerHTML;
        value = value.substring(11);

        localStorage.setItem("totalAmt",value);
        window.location.href = "/payment";
      }
    
    
    </script>


</head>

<body>
    <!-- *** Navbar *** -->
  <nav class="navbar navbar-expand-lg navbar-light" style="background: none;">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="images/logospice2.jpg" class="img-fluid" alt="logo">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about">About Us</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Product
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Spices</a></li>
              <li><a class="dropdown-item" href="#">Primum Spices</a></li>
              <li><a class="dropdown-item" href="#">Dry Fruits</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#contactus">Contact</a>
          </li>
        </ul>
        {{!-- <form class="d-flex" role="search" style="width: 7%;" >
          <a type="button" class="nav-link" href="/login" id="login">login</a>
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-dark" type="submit">Search</button>
        </form> --}}
      </div>
    </div>
  </nav>



    <div class="cart-box">
      <div class="cart-icon">
        <i class="fas fa-cart-arrow-down fa-2x"></i>
      </div>
      <div class="whole-cart-window hide">
        <h2>Shopping Bag</h2>
        <div class="cart-wrapper">
          <!-- <div class="cart-item">
                       <img src="\img\pic5.jpeg"> 
                       <div class="details">
                           <h3>Item Name</h3>
                           <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                            <span class="quantity">Quantity: 1</span>
                               <span class="price">Price: $23.44</span>
                           </p>
                       </div>
                       <div class="cancel"><i class="fas fa-window-close"></i></div>
                    </div> -->
          <!-- item 2 -->
          <!-- <div class="cart-item">
                        <img src="\img\pic5.jpeg"> 
                        <div class="details">
                            <h3>Item Name</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                             <span class="quantity">Quantity: 1</span>
                                <span class="price">Price: $23.44</span>
                            </p>
                        </div>
                        <div class="cancel"><i class="fas fa-window-close"></i></div>
                     </div> -->
        </div>
        <div class="subtotal" id="subtotal">Subtotal: ₹0.00</div>
        <div class="checkout" onclick="checkoutPage()">Checkout</div>
        {{!-- <div class="view-cart">View Cart</div> --}}
      </div>
    </div>

  <section class="shop-section">
    <div class="card-wrapper">
      <div data-id="1" class="card-item">
        <img src="https://www.unlockfood.ca/EatRightOntario/media/Website-images-resized/How-to-cook-with-spices-resized.jpg" />
        <div class="details">
          <h3>Masala Combo</h3>
          <p>
            {{!-- <span>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit.
            </span> --}}

            <span class="price">Price: ₹145</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>
      <!-- item 2 -->
      <div data-id="2" class="card-item">
        <img src="images/spiceimg2.jpg" />
        <div class="details">
          <h3>Traditional Masala Combo</h3>
          <p>
            {{!-- <span>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit.
            </span> --}}

            <span class="price">Price: ₹100</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>

      <!-- product 3 -->
      <div data-id="3" class="card-item">
        <img src="images/spiceimg4.jpg" />
        <div class="details">
          <h3>Special Garam Masala</h3>
          <p>
            {{!-- <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</span> --}}

            <span class="price">Price: ₹129</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>

      <!-- product 4 -->
      <div data-id="4" class="card-item">
        <img src="images/spiceimg14.jpg" />
        <div class="details">
          <h3>Traditional Masala Combo</h3>
          <p>
            {{!-- <span>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit.
            </span> --}}

            <span class="price">Price: ₹169</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>
      <!-- product 5 -->
      <div data-id="5" class="card-item">
        <img src="images/spiceimg20.jpg" />
        <div class="details">
          <h3>Kashmiri Mirchi Powder</h3>
          <p>
            {{!-- <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</span> --}}
            <span class="price">Price: ₹99</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>

      <!-- product 6 -->
      <div data-id="6" class="card-item">
        <img src="images/spiceimg7.jpg" />
        <div class="details">
          <h3>Pav Bhaji Masala</h3>
          <p>
            {{!-- <span>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit.
            </span> --}}

            <span class="price">Price: ₹49</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>

      <!-- product 7 -->
      <div data-id="7" class="card-item">
        <img src="images/spiceimg10.jpg" />
        <div class="details">
          <h3>Special Biryani Masala</h3>
          <p>
            {{!-- <span>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit.
            </span> --}}

            <span class="price">Price: ₹80</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>

      <!-- product 8 -->
      <div data-id="8" class="card-item">
        <img src="images/spiceimg9.jpg" />
        <div class="details">
          <h3>Rajwadi Masale</h3>
          <p>
            {{!-- <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</span> --}}

            <span class="price">Price: ₹50</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>

      <!-- product 9 -->

      <div data-id="9" class="card-item">
        <img src="images/spiceimg8.jpg" />
        <div class="details">
          <h3>Peshwai Masale</h3>
          <p>
            {{!-- <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</span> --}}

            <span class="price">Price: ₹190</span>
            <span class="add-to-cart-btn">Add To Cart</span>
          </p>
        </div>
      </div>
    </div>
  </section>


  <!-- *** footer *** -->
  <footer class="footer-section">
    <div class="container">
      <div class="footer-cta py-5">
        <div class="row">
          <div class="col-sm-6 col-xl-4 mb-30">
            <div class="single-cta">
              <i class="fas fa-map-marker-alt"></i>
              <div class="cta-text">
                <h4>Find us</h4>
                <span>Shop No 6, Shree Ganesh Mini Market, Sector - 12, Cisf Road, Kharghar, Near Air Cool Services, Navi Mumbai-410210</span>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-xl-4 mb-30">
            <div class="single-cta">
              <i class="fas fa-phone"></i>
              <div id="contactus" class="cta-text">
                <h4>Call us</h4>
                <span>9923579312 | 9967522587</span>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-xl-4 mb-30">
            <div class="single-cta">
              <i class="fas fa-envelope-open"></i>
              <div class="cta-text">
                <h4>Mail us</h4>
                <span>shagunmasale@gmail.com</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-content py-5">
        <div class="row">
          <div class="col-lg-4">
            <div class="footer-widget">
              <div class="footer-logo">
                <a href="#"><img src="images/logo.jpg" class="img-fluid"></a>
              </div>
              <div class="footer-text">
                <p>Open 9am - 9pm </p>
              </div>
              <div class="footer-social-icon">
                <span>Follow us</span>
                <a href="https://www.facebook.com"><i class="fab fa-facebook-f facebook-bg"></i></a>
                <a href="#"><i class="fab fa-twitter twitter-bg"></i></a>
                <a href="#"><i class="fab fa-instagram instagram-bg"></i></a>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer-widget">
              <div class="footer-widget-heading">
                <h3>Useful Links</h3>
              </div>
              <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/about">about</a></li>
                {{!-- <li><a href="#">services</a></li>
                <li><a href="#">portfolio</a></li> --}}
                <li><a href="#">Contact</a></li>
                <li><a href="/about">About us</a></li>
                {{!-- <li><a href="#">Our Services</a></li>
                <li><a href="#">Expert Team</a></li> --}}
                <li><a href="#contactus">Contact us</a></li>
                {{!-- <li><a href="#">Latest News</a></li> --}}
              </ul>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="footer-widget">
              <div class="footer-widget-heading">
                <h3>Subscribe</h3>
              </div>
              <div class="footer-text">
                <p>Don't miss to subscribe to our new feeds, kindly fill the form below.</p>
              </div>
              <div class="subscribe-form">
                <form action="#">
                  <input type="text" placeholder="Email Address">
                  <button><i class="fab fa-telegram-plane"></i></button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="copyright-area">
      <div class="container">
        <div class="row">
          <div class="col-xl-6 col-lg-6 text-center text-lg-left">
            <div class="copyright-text">
              <p>Copyright © 2021, All Right Reserved </p>
            </div>
          </div>
          <!-- <div class="col-xl-6 col-lg-6 text-right d-none d-lg-block">
                    <div class="footer-menu">
                        <ul>
                            <li><a href="#">Home</a></li>
                            <li><a href="#">Terms</a></li>
                            <li><a href="#">Privacy</a></li>
                            <li><a href="#">Policy</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </div>
                </div> -->
        </div>
      </div>
    </div>
  </footer>

  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
    crossorigin="anonymous"></script>

  {{!--
  <script src="script.js"></script> --}}
  <script>
   

    class CartItem {
      constructor(name, desc, img, price) {
        this.name = name
        this.desc = desc
        this.img = img
        this.price = price
        this.quantity = 1
      }
    }

    class LocalCart {
      static key = "cartItems"

      static getLocalCartItems() {
        let cartMap = new Map()
        const cart = localStorage.getItem(LocalCart.key)
        console.log(cart)
        if (cart === null || cart.length === 0) return cartMap
        
        return new Map(Object.entries(JSON.parse(cart)))
      }

      static addItemToLocalCart(id, item) {
        let cart = LocalCart.getLocalCartItems()
        if (cart.has(id)) {
          let mapItem = cart.get(id)
          mapItem.quantity += 1
          cart.set(id, mapItem)
        }
        else
          cart.set(id, item)
        localStorage.setItem(LocalCart.key, JSON.stringify(Object.fromEntries(cart)))
        updateCartUI()

      }

      static removeItemFromCart(id) {
        let cart = LocalCart.getLocalCartItems()
        if (cart.has(id)) {
          let mapItem = cart.get(id)
          if (mapItem.quantity > 1) {
            mapItem.quantity -= 1
            cart.set(id, mapItem)
          }
          else
            cart.delete(id)
        }
        if (cart.length === 0)
          localStorage.clear()
        else
          localStorage.setItem(LocalCart.key, JSON.stringify(Object.fromEntries(cart)))
        updateCartUI()
      }
    }


    const cartIcon = document.querySelector('.fa-cart-arrow-down')
    const wholeCartWindow = document.querySelector('.whole-cart-window')
    wholeCartWindow.inWindow = 0
    const addToCartBtns = document.querySelectorAll('.add-to-cart-btn')
    addToCartBtns.forEach((btn) => {
      btn.addEventListener('click', addItemFunction)
    })

    function addItemFunction(e) {
      const id = e.target.parentElement.parentElement.parentElement.getAttribute("data-id")
      const img = e.target.parentElement.parentElement.previousElementSibling.src
      const name = e.target.parentElement.previousElementSibling.textContent
      const desc = e.target.parentElement.children[0].textContent
      let price = e.target.parentElement.children[1].textContent
      price = price.replace("Price: ₹ ", '')
      const item = new CartItem(name, desc, img, price)
      LocalCart.addItemToLocalCart(id, item)
      console.log(price)
    }


    cartIcon.addEventListener('mouseover', () => {
      if (wholeCartWindow.classList.contains('hide'))
        wholeCartWindow.classList.remove('hide')
    })

    cartIcon.addEventListener('mouseleave', () => {
      // if(wholeCartWindow.classList.contains('hide'))
      setTimeout(() => {
        if (wholeCartWindow.inWindow === 0) {
          wholeCartWindow.classList.add('hide')
        }
      }, 500)

    })

    wholeCartWindow.addEventListener('mouseover', () => {
      wholeCartWindow.inWindow = 1
    })

    wholeCartWindow.addEventListener('mouseleave', () => {
      wholeCartWindow.inWindow = 0
      wholeCartWindow.classList.add('hide')
    })


    function updateCartUI() {
      const cartWrapper = document.querySelector('.cart-wrapper')
      cartWrapper.innerHTML = ""
      const items = LocalCart.getLocalCartItems()
      if (items === null) return
      let count = 0
      let total = 0
      console.log(items)
      for (const [key, value] of items.entries()) {
        console.log(value);
        const cartItem = document.createElement('div')
        cartItem.classList.add('cart-item')
        let price = Number(value.desc.split(':')[1].slice(2))* value.quantity
        //price = Math.round(price * 100) / 100
        console.log(value.desc.split(':')[1].slice(2))
        count += 1
        total += price
        total = Math.round(total * 100) / 100
        cartItem.innerHTML =
          `
        <img src="${value.img}"> 
                       <div class="details">
                           <h3>${value.name}</h3>
                           <p>${value.desc}
                            <span class="quantity">Quantity: ${value.quantity}</span>
                               <span class="price">Price: ₹ ${price}</span>
                           </p>
                       </div>
                       <div class="cancel"><i class="fas fa-window-close"></i></div>
        `
        cartItem.lastElementChild.addEventListener('click', () => {
          LocalCart.removeItemFromCart(key)
        })
        cartWrapper.append(cartItem)
      }

      if (count > 0) {
        cartIcon.classList.add('non-empty')
        let root = document.querySelector(':root')
        root.style.setProperty('--after-content', `"${count}"`)
        const subtotal = document.querySelector('.subtotal')
        subtotal.innerHTML = `SubTotal: ₹${total}`
      
      }
      else
        cartIcon.classList.remove('non-empty')
    }
    document.addEventListener('DOMContentLoaded', () => { updateCartUI() })
    
  </script>
</body>

</html>